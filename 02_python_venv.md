# Venv

## Что такое?
Виртуальное окружение или `virtual environment` или `virtualenv` или `venv` это встроенный в Python удобный механизм изоляции окружения вашего проекта. Нужно это для того, чтобы:
- не засорять системное Python окружение
- иметь возможность работать над несколькими проектами, которые зачастую могут требовать установки одних и тех же библиотек, но разных версий

## Предварительные требования
В системе должен быть установлен Python >= 3.8 (доступен в PowerShell терминале по команде py)

## Coздать виртуальное окружение
```sh
py -m venv venv_name
```
Эта команда создаст в текущей директории папку с именем `venv_name` и поместит туда минимальный необходимый набор файлов для дальнейшей работы виртуального окружения.

## Активировать venv
```sh
.\venv_name\Scripts\activate
```
После выполнения этой команды у вас слева в приглашении командной строки появится префикс `(venv_name)`. Это будет означать, что теперь, когда вы запускаете команду `py`, то интерпретатор будет видеть все библиотеки, установленные в этот venv.

## Установка пакетов
Перед запуском команды должен быть активирован venv. Давайте, например, установим библиотеку, реализующую клиентскую часть протокола HTTP
```sh
pip install requests
```

## Создание своего проекта
- Cначала нужно создать директорию с своим проектом
```bash
mkdir project
```

- Далее в проекте нужно создать файл setup.py со следующим содержанием
```python
import setuptools
from setuptools import find_packages

setuptools.setup(
    name="spidercode",
    version="0.0.1",
    packages=find_packages(),
    description="Spider code",
    author="Peter Parker",
    classifiers=[
        "Intended Audience :: Information Technology",
        "Programming Language :: Python",
        "Programming Language :: Python :: 3",
    ],
)
```

- Далее в проекте создайте директорию `spidercode` (это название вашего Python пакета)
```
cd project
mkdir spidercode
```
- Внутри этой директории можно создавать пакеты и модули вашего проекта.
    - Директория с файлом `__init__.py` считается пакетом.
    - Файлы с расширением `.py`, содержащие объявления переменных, определения функций и классов, которые можно импортировать называются модулями.

Например, давайте создадим файл `main.py` следующим содержимым
```python
def greeting(name):
    print(f"Hello, {name}!")
```

В итоге структура нашего проекта будет выглядеть так
```sh
├── setup.py
└── spidercode
    ├── __init__.py
    └── main.py
```

- Далее нужно установить ваш пакет в `venv`
    - Для разработки (в venv-е создадутся ссылки на модули вашего пакета)
    ```sh
    py setup.py develop
    ```
    - Для установки (в venv скопируются модули вашего пакета)
    ```sh
    py setup.py install
    ```

## Использование библиотек
Любые установленные в venv пакеты, включая ваш собственный теперь можно использовать в вашем коде.

Например, создадим файл `sample.py`
```python
from spidercode.main import greeting

greeting("world")
```

Теперь можно запускать ваш код
```sh
py sample.py
```
На вашем терминале должно напечататься
```
Hello, world!
```

## VSCode
Редактор VSCode имеет систему расширений. Вам нужно установить расширение Python от Microsoft.
Далее нужно выбрать ваш venv в качестве интерпретатора для вашего проекта.

Ctrl+Shift+P -> python select interpreter -> Enter interpreter path -> вбиваете путь к вашему venv, например ~\venv_name\Scripts\python.exe

Редактор будет видеть все установленные в venv библиотеки со всеми вытекающими последствиями.